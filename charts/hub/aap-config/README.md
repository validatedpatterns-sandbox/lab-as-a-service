# aap-config

![Version: 0.1.4](https://img.shields.io/badge/Version-0.1.4-informational?style=flat-square)

A Helm chart to build and deploy secrets using external-secrets for ansible-edge-gitops

This chart is used to set up the Ansible Automation Platform Operator version 2.5.

### Notable changes

* v0.1.2: Introduce EXTRA_PLAYBOOK_OPTS to config job, to allow for extra vars and
-v options (usually -vvv) to be passed to playbook to help debug it

* v0.1.3: Introduce "bootstrap" phase; this means that the config job will run until
it succeeds, and only then proceed to create the cronjob to re-configure. It also
means the cronjob scheduling is nowehere near as aggressive (every even hour at
the 10-minute mark instead of every ten minutes as previously).

* v0.1.4: Use vp-rbac subchart to configure RBACs instead of local code. Introduce
external secrets validation job to prevent argo from proceeding past ES creation and
erroring out early.

## Requirements

| Repository | Name | Version |
|------------|------|---------|
| https://charts.validatedpatterns.io | vp-rbac | 0.1.* |

## Values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| aap.eda_disabled | bool | `false` |  |
| aap.hub_disabled | bool | `true` |  |
| aap.lightspeed_disabled | bool | `true` |  |
| aapManifest.key | string | `"secret/data/hub/aap-manifest"` |  |
| configJob.activeDeadlineSeconds | int | `3600` |  |
| configJob.configTimeout | int | `1800` |  |
| configJob.image | string | `"quay.io/rhn_support_mbaldess/ansible-aap-config-container:latest"` |  |
| configJob.imagePullPolicy | string | `"Always"` |  |
| configJob.schedule | string | `"10 */2 * * *"` |  |
| global.repoURL | string | `"test"` |  |
| global.targetRevision | string | `"main"` |  |
| secretStore.kind | string | `"ClusterSecretStore"` |  |
| secretStore.name | string | `"vault-backend"` |  |
| serviceAccountName | string | `"aap-config-sa"` |  |
| serviceAccountNamespace | string | `"ansible-automation-platform"` |  |
| validationJob.activeDeadlineSeconds | int | `600` |  |
| validationJob.disabled | bool | `false` |  |
| vp-rbac.roles.create-secrets.rules[0].apiGroups[0] | string | `""` |  |
| vp-rbac.roles.create-secrets.rules[0].resources[0] | string | `"secrets"` |  |
| vp-rbac.roles.create-secrets.rules[0].verbs[0] | string | `"create"` |  |
| vp-rbac.roles.create-secrets.rules[0].verbs[1] | string | `"get"` |  |
| vp-rbac.roles.create-secrets.rules[0].verbs[2] | string | `"list"` |  |
| vp-rbac.serviceAccounts.aap-config-sa.namespace | string | `"ansible-automation-platform"` |  |
| vp-rbac.serviceAccounts.aap-config-sa.roleBindings.roles[0] | string | `"create-secrets"` |  |

----------------------------------------------
Autogenerated from chart metadata using [helm-docs v1.14.2](https://github.com/norwoodj/helm-docs/releases/v1.14.2)
